{
  "hash": "b8768187d47498713a0ddd3c039df2ec",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Module 12 Assignment\"\nauthor: \"Robert Walsh\"\nimage: \"timeseries.png\"\ndate: \"2025-04-05\"\n---\n\n\n\nExercise in Time Series Regression!\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Question A.\n\n# The table below represents charges for a student credit card. \n```\n:::\n\n\n\n<img src=\"charges.png\" alt=\"Girl in a jacket\" width=\"500\" height=\"600\"/>\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# A1. Construct a time series plot using R.\n\n# Enter data:\n\ncharge<-c(31.9,27,31.3,31,39.4,40.7,42.3,49.5,45,50,50.9,58.5,39.4,36.2,40.5,44.6,46.8,44.7,52.2,54,48.8 ,55.8,58.7,63.4)\nchargeTimeSeries<-ts(charge,frequency=12,start=c(2012,1))\nchargeTimeSeries\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      Jan  Feb  Mar  Apr  May  Jun  Jul  Aug  Sep  Oct  Nov  Dec\n2012 31.9 27.0 31.3 31.0 39.4 40.7 42.3 49.5 45.0 50.0 50.9 58.5\n2013 39.4 36.2 40.5 44.6 46.8 44.7 52.2 54.0 48.8 55.8 58.7 63.4\n```\n\n\n:::\n\n```{.r .cell-code}\n# Plot the time series regression:\nplot.ts(chargeTimeSeries)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# A2. Employ the Exponential Smoothing Model as outlined in Avril Voghlan's\n#     notes and report the statistical  outcome:\nchargeTimeSeriesForecasts<-HoltWinters(chargeTimeSeries)\nchargeTimeSeriesForecasts\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nHolt-Winters exponential smoothing with trend and additive seasonal component.\n\nCall:\nHoltWinters(x = chargeTimeSeries)\n\nSmoothing parameters:\n alpha: 0.4786973\n beta : 0\n gamma: 0.1\n\nCoefficients:\n           [,1]\na    51.4481469\nb     0.6088578\ns1   -6.6831338\ns2  -10.5867440\ns3   -6.6998393\ns4   -3.0320795\ns5   -1.4068647\ns6   -4.0422184\ns7    0.4727766\ns8    6.6378768\ns9    1.4431586\ns10   5.6809745\ns11   5.7999737\ns12  12.6976853\n```\n\n\n:::\n\n```{.r .cell-code}\n# The output of HoltWinters() estimates the alpha @ 0.4786973\n# Close to .50, suggesting that the forecasts are based on both\n# the past and future observations almost equal weight.\n\n# Plot with Exponential Smoothing:\nplot(chargeTimeSeriesForecasts)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# The original time series in black, and the red line is the forecast.\n# The time series regression of forecasts is smoother.\n\n\n# The distance between the fitted value and the actual observed value.\n# Using the measure of accuracy, or sum of squared errors:\nchargeTimeSeriesForecasts$SSE\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 62.88946\n```\n\n\n:::\n\n```{.r .cell-code}\n# A3. Provide a discussion on the time series and Exponential Smoothing\n#     Model result you led to. \n\n# This time series could be described using an additive model,\n# the seasonal and random fluctuations seem to be roughly constant\n# in size over time with an overall positive trend including\n# some annual seasonal increase/decrease trends as well:\n\n# The students spend the least at the beginning of the year,\n# a significant increase in the middle of the year,\n# and spend the most towards the end of the year.\n# There is a sharp decline in spending at the beginning of each new year.\n\n# To learn more about the component trends of the data set, the \n# decompose() function can be used:\nchargeTimeSeriesComponents<-decompose(chargeTimeSeries)\nplot(chargeTimeSeriesComponents)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-3.png){width=672}\n:::\n\n```{.r .cell-code}\n# The top chart shows the observed data.\n\n# The trend shows an increase from 41.77083 in July 2012 to\n# 48.55417 in June of 2013.\n\n# The \"seasonal\" components:\nchargeTimeSeriesComponents$seasonal\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n             Jan         Feb         Mar         Apr         May         Jun\n2012  -6.8986111 -10.6986111  -6.7444444  -3.0444444  -1.4111111  -4.0402778\n2013  -6.8986111 -10.6986111  -6.7444444  -3.0444444  -1.4111111  -4.0402778\n             Jul         Aug         Sep         Oct         Nov         Dec\n2012   0.3430556   6.8472222   1.5805556   5.6305556   5.6555556  12.7805556\n2013   0.3430556   6.8472222   1.5805556   5.6305556   5.6555556  12.7805556\n```\n\n\n:::\n\n```{.r .cell-code}\n# These figures confirm the sharp -6.8986111 to -10.6986111 decline from\n# Jan. into Feb., the 6.8472222 increase in Aug. and the 12.7805556\n# increase in Dec.\n\n# Using simple exponential smoothing to make short-term future forecasts.\nlibrary(\"forecast\")\nchargeFutureForecast <- forecast(chargeTimeSeriesForecasts,h=12)\nplot(chargeFutureForecast)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-4.png){width=672}\n:::\n\n```{.r .cell-code}\n# This plot displays the prediction for 2014.\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}