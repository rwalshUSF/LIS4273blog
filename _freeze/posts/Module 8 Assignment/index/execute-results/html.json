{
  "hash": "b1c5f109932f0f6299d4b26254a9a166",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Module 8 Assignment\"\nauthor: \"Robert Walsh\"\nimage: \"anova.jpg\"\ndate: \"2025-03-05\"\n---\n\n\n\nAn Exercise in ANOVA, analysis of variance!\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Question A.\n\n# A researcher is interested in the effects of drug against\n# stress reactions. She gives a reaction time test to three\n# different groups of subjects:\n# one group that is under a great deal of stress,\n# one group under a moderate amount of stress,\n# and a third group that is under almost no stress.\n# The subjects of the study were instructed to take the drug test\n# during their next stress episode and to report their stress on a\n# scale of 1 to 10 (10 being the most pain).\n\ndf<-data.frame(\"High.Stress\"=c(10,9,8,9,10,8),\n               \"Moderate.Stress\"=c(8,10,6,7,8,8),\n               \"Low.Stress\"=c(4,6,6,4,2,2))\ndf\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  High.Stress Moderate.Stress Low.Stress\n1          10               8          4\n2           9              10          6\n3           8               6          6\n4           9               7          4\n5          10               8          2\n6           8               8          2\n```\n\n\n:::\n\n```{.r .cell-code}\nstress.pain.level<-c(df$High.Stress,df$Moderate.Stress,df$Low.Stress)\n\nsubject.group.amount<-factor(c(rep(\"High\",6),\n                        rep(\"Moderate\",6),\n                        rep(\"Low\",6)),\n                        levels = c(\"High\",\"Moderate\",\"Low\"))\n\n# Report on drug and stress level by using R.\n# Provide a full summary report on the result\n# of ANOVA testing and what it means.\n\n# Look at the means for stress level by group:\ntapply(stress.pain.level,subject.group.amount,mean)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    High Moderate      Low \n9.000000 7.833333 4.000000 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Look at the variations for stress level by group:\ntapply(stress.pain.level,subject.group.amount,var)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    High Moderate      Low \n0.800000 1.766667 3.200000 \n```\n\n\n:::\n\n```{.r .cell-code}\n# Look at a boxplot graph:\nboxplot(stress.pain.level ~ subject.group.amount,\n        main = \"Effects of Drug Against Stress Reactions\",\n        xlab = \"Stress amount groups\",\n        ylab = \"Stress level pain (1-10)\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# More specifically, report the following:\n# Df, Sum, Sq Mean, Sq, F value, Pr(>F)\n\n# Did the drug have any affect on specific groups stress levels?\n\n# Test the difference between the means of the groups with ANOVA.\n\n# Null Ho: The mean stress levels are similar between groups\n# Alt  Ha: The mean stress levels are significantly different between groups\naov.out<-aov(stress.pain.level ~ subject.group.amount,data = df)\nsummary(aov.out)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                     Df Sum Sq Mean Sq F value   Pr(>F)    \nsubject.group.amount  2  82.11   41.06   21.36 4.08e-05 ***\nResiduals            15  28.83    1.92                     \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n```\n\n\n:::\n\n```{.r .cell-code}\n# The Df for subject.group.amount is '2' because there are three\n# groups sampled, so k-1 = 2, where k = number of groups sampled.\n# for the residuals row, the Df is '15' because there are 6 observations\n# in 3 samples, so N-k = 18-3 = 15.\n\n# Sum Sq is for 'Sum of the Squares' which is measuring the variance,\n# the higher this number is = more variance in the data, or groups.\n# Sum Sq for subject.group.amount, SS(B) = 82.11, indicating a large\n# variance between the groups, and Sum Sq for the residuals, SS(W) = 28.83\n# indicating a large variance within the groups as well.\n# Adding both of these would give the Total Variance.\n# SS(B)+SS(W)=SS(T)\n\n# Mean Sq normalizes the Sums of Squares by calculating mean squares.\n# Size of obtained mean differences (including treatment effects) = MS(B)\n# The Mean Sq for 'subject.group.amount' is: MS(B)=SS(B)/(K-1) = 41.06,\n# There is a large difference between the means in the sample groups.\n# Size of expected differences by chance (without treatment effects) = MS(W)\n# The Mean Sq for the residuals is: MS(W)=SS(W)/(N-k) = 1.92\n# The residuals row shows a smaller difference within the sample groups.\n\n# The F value is the result of MS(B)/MS(W) = 21.36\n# This test accounts for the random variation causing difference\n# in the mean squares and is the analysis of variance between means.\n# A value close to '1' indicates that the treatment has little to no effect\n# on the group means, which does not signify a difference between groups,\n# and there is not enough evidence to reject the Null Hypothesis that the\n# means are very similar or identical.\n# A large F value indicates a significant treatment effect, and would \n# cause the Null Hypothesis of similar means to be rejected because there\n# is enough evidence for the Alternative Hypothesis to be considered.\n\n# The Pr(>F) from ANOVA works like similar p-value significance tests.\n# 95% confidence needs a p-value less than 0.05 to reject the Null.\n# In this test the p-value = 4.08e-05, is significantly smaller than 0.001,\n# indicating that the statistics are very significant.\n\n# The large F value at 21.36 and the low 4.08e-05 p-value suggests\n# evidence against the null hypothesis. Therefore, it can be assumed\n# that the mean stress levels differ significantly among the three groups.\n\n# Question B.\n\n# From our Textbook: Introductory Statistics with R.\n# Chapter # 6 Exercises 6.1 pp. 127 plus.\n# The zelazo data (taken from the textbook's R package called ISwR)\n# are in the form of a list of vectors, one for each of the four groups.\n\n# B1. Convert the data to a form suitable for the user of lm,\n# and calculate the relevant test.\nlibrary(ISwR)\ndata(\"zelazo\")\nsummary(zelazo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n        Length Class  Mode   \nactive  6      -none- numeric\npassive 6      -none- numeric\nnone    6      -none- numeric\nctr.8w  5      -none- numeric\n```\n\n\n:::\n\n```{.r .cell-code}\n# To convert the data for linear model, lm()\n# A 'value' column will hold the combined response variables\n# A 'group' factor will create the categorical variable that\n# will be used to combine the predictor variables\nzelazo.df<-data.frame(\nvalue=unlist(zelazo,use.names = F),\ngroup=factor(rep(c(\"active\",\"passive\",\"none\",\"ctr.8w\"),sapply(zelazo,length)),\nlevels = c(\"active\",\"passive\",\"none\",\"ctr.8w\")))\nzelazo.df\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   value   group\n1   9.00  active\n2   9.50  active\n3   9.75  active\n4  10.00  active\n5  13.00  active\n6   9.50  active\n7  11.00 passive\n8  10.00 passive\n9  10.00 passive\n10 11.75 passive\n11 10.50 passive\n12 15.00 passive\n13 11.50    none\n14 12.00    none\n15  9.00    none\n16 11.50    none\n17 13.25    none\n18 13.00    none\n19 13.25  ctr.8w\n20 11.50  ctr.8w\n21 12.00  ctr.8w\n22 13.50  ctr.8w\n23 11.50  ctr.8w\n```\n\n\n:::\n\n```{.r .cell-code}\n# Boxplot to view age at walking values by four group levels\nboxplot(zelazo.df$value~zelazo.df$group,\n        main = \"Effects of Training on Infant Walking Ages\",\n        xlab = \"Training Level Groups\",\n        ylab = \"Walking Age in Months\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-2.png){width=672}\n:::\n\n```{.r .cell-code}\n# Model and call the linear model, lm()\n# This will model the relationship between the magnitude of one\n# variable and that of a second\nzelazo.lm<-lm(zelazo.df$value~zelazo.df$group)\nsummary(zelazo.lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = zelazo.df$value ~ zelazo.df$group)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.7083 -0.8500 -0.3500  0.6375  3.6250 \n\nCoefficients:\n                       Estimate Std. Error t value Pr(>|t|)    \n(Intercept)             10.1250     0.6191  16.355 1.19e-12 ***\nzelazo.df$grouppassive   1.2500     0.8755   1.428   0.1696    \nzelazo.df$groupnone      1.5833     0.8755   1.809   0.0864 .  \nzelazo.df$groupctr.8w    2.2250     0.9182   2.423   0.0255 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.516 on 19 degrees of freedom\nMultiple R-squared:  0.2528,\tAdjusted R-squared:  0.1348 \nF-statistic: 2.142 on 3 and 19 DF,  p-value: 0.1285\n```\n\n\n:::\n\n```{.r .cell-code}\n# The residual standard error of 1.516 could be considered small\n# indicating that the regression model fits the data set well.\n# The median value in the distribution of the residuals is close to zero\n# at -0.3500 and the min & max are roughly equal in absolute value.\n# An F-value of 2.14 with a p-value of 0.1285 indicates that there is not\n# enough evidence to reject the null hypothesis that the model with no\n# independent variables fits the data as well as the model including treatment\n# effects.The observed differences between groups are likely due to chance,\n# as the p-value is relatively high and not statistically significant at the\n# standard 0.05 significance level. To find the relationship between groups\n# that is causing the difference, further investigation is necessary.\n\n# Consider t-tests comparing selected subgroups\n# or obtained by combining groups.\n\n# The only group in the regression summary that showed significant\n# statistical results was the 'ctr.8w' control group with a t-value\n# of 2.423 and a Pr(>|t|) value of 0.0255 * indicating significant evidence\n# to reject the null that the true coefficient of the control group and the\n# intercept is equal to zero, and a relationship between the variables exists.\n\n# So I will begin by using t-tests to compare the subgroups of the \n# control group and the other groups to test for significant differences\n# between the means of the groups.\ntapply(zelazo.df$value,zelazo.df$group,var)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  active  passive     none   ctr.8w \n2.093750 3.593750 2.310417 0.925000 \n```\n\n\n:::\n\n```{.r .cell-code}\n# The variances are not the same between the groups so the Welch's\n# variant of the t-test is sufficient.\n\n# Two sample t-test comparing the means of 'none' group to 'control' group\nt.test.result1<-t.test(zelazo.df$value~zelazo.df$group,\ndata=zelazo.df,\nsubset=group%in%c(\"none\",\"ctr.8w\"))\nt.test.result1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  zelazo.df$value by zelazo.df$group\nt = -0.84986, df = 8.5046, p-value = 0.4187\nalternative hypothesis: true difference in means between group none and group ctr.8w is not equal to 0\n95 percent confidence interval:\n -2.364947  1.081614\nsample estimates:\n  mean in group none mean in group ctr.8w \n            11.70833             12.35000 \n```\n\n\n:::\n\n```{.r .cell-code}\n# The p-value of 0.4187 is > 0.05 alpha, so there is not significant evidence\n# to reject the null hypothesis that there is no difference between the means\n\n# Two sample t-test comparing the means of 'passive' group to 'control' group\nt.test.result2<-t.test(zelazo.df$value~zelazo.df$group,\ndata=zelazo.df,\nsubset=group%in%c(\"passive\",\"ctr.8w\"))\nt.test.result2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  zelazo.df$value by zelazo.df$group\nt = -1.1012, df = 7.6531, p-value = 0.3042\nalternative hypothesis: true difference in means between group passive and group ctr.8w is not equal to 0\n95 percent confidence interval:\n -3.032993  1.082993\nsample estimates:\nmean in group passive  mean in group ctr.8w \n               11.375                12.350 \n```\n\n\n:::\n\n```{.r .cell-code}\n# The p-value of 0.3042 is > 0.05 alpha, so there is not significant evidence\n# to reject the null hypothesis that there is no difference between the means\n\n# Two sample t-test comparing the means of active group to control group\nt.test.result3<-t.test(zelazo.df$value~zelazo.df$group,\ndata=zelazo.df,\nsubset=group%in%c(\"active\",\"ctr.8w\"))\nt.test.result3\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  zelazo.df$value by zelazo.df$group\nt = -3.0449, df = 8.6632, p-value = 0.01453\nalternative hypothesis: true difference in means between group active and group ctr.8w is not equal to 0\n95 percent confidence interval:\n -3.8878619 -0.5621381\nsample estimates:\nmean in group active mean in group ctr.8w \n              10.125               12.350 \n```\n\n\n:::\n\n```{.r .cell-code}\n# The p-value of 0.01453 is < 0.05 alpha, so there is significant evidence\n# to reject the null hypothesis that there is no difference between the means!\n# We can conclude that a difference between these two groups' means exists!\n\n\n\n# B2. Consider the ANOVA test (one-way or two-way) for this dataset (zelazo)\n\n# The one-way ANOVA test will test the null hypothesis that there is no\n# difference between the means of the group that received the treatment and \n# the means of the groups that did not receive the treatment.\n\n# h0: All group means are equal\n# ha: All group means are not equal\n\n# The one-way test to compare differences between the group means\noneway.test(zelazo.df$value~zelazo.df$group)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tOne-way analysis of means (not assuming equal variances)\n\ndata:  zelazo.df$value and zelazo.df$group\nF = 2.7759, num df = 3.000, denom df = 10.506, p-value = 0.09373\n```\n\n\n:::\n\n```{.r .cell-code}\n# With an F value = 2.7759, and p-value = 0.09373, we fail to reject the null\n# hypothesis that all group means are equal. This is strange because we know\n# they are different somehow, further analysis of the groups is needed.\n\n# The aov() function fits analysis of variance (ANOVA)\n# models directly to the data\nzelazo.aov<-aov(zelazo.df$value~zelazo.df$group,data=zelazo.df)\nzelazo.aov\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nCall:\n   aov(formula = zelazo.df$value ~ zelazo.df$group, data = zelazo.df)\n\nTerms:\n                zelazo.df$group Residuals\nSum of Squares         14.77781  43.68958\nDeg. of Freedom               3        19\n\nResidual standard error: 1.516394\nEstimated effects may be unbalanced\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(zelazo.aov)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n                Df Sum Sq Mean Sq F value Pr(>F)\nzelazo.df$group  3  14.78   4.926   2.142  0.129\nResiduals       19  43.69   2.299               \n```\n\n\n:::\n\n```{.r .cell-code}\n# It returns an ANOVA table with sources of variation and associated statistics\n\n# The anova() function performs analysis of variance (ANOVA)\n# on model objects\nanova(zelazo.lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nAnalysis of Variance Table\n\nResponse: zelazo.df$value\n                Df Sum Sq Mean Sq F value Pr(>F)\nzelazo.df$group  3 14.778  4.9259  2.1422 0.1285\nResiduals       19 43.690  2.2995               \n```\n\n\n:::\n\n```{.r .cell-code}\n# It returns an ANOVA table comparing models or factors,\n# showing sources of variation and statistics\n\n# Which yields the same results as the lm() \nsummary(zelazo.lm)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = zelazo.df$value ~ zelazo.df$group)\n\nResiduals:\n    Min      1Q  Median      3Q     Max \n-2.7083 -0.8500 -0.3500  0.6375  3.6250 \n\nCoefficients:\n                       Estimate Std. Error t value Pr(>|t|)    \n(Intercept)             10.1250     0.6191  16.355 1.19e-12 ***\nzelazo.df$grouppassive   1.2500     0.8755   1.428   0.1696    \nzelazo.df$groupnone      1.5833     0.8755   1.809   0.0864 .  \nzelazo.df$groupctr.8w    2.2250     0.9182   2.423   0.0255 *  \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 1.516 on 19 degrees of freedom\nMultiple R-squared:  0.2528,\tAdjusted R-squared:  0.1348 \nF-statistic: 2.142 on 3 and 19 DF,  p-value: 0.1285\n```\n\n\n:::\n\n```{.r .cell-code}\nplot(zelazo.lm)\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-6.png){width=672}\n:::\n\n```{.r .cell-code}\n# Because the p-value is > 0.05, we fail to reject the null hypothesis\n# that each group mean is equal, However, Post-Hoc Tests can be\n# used to explore how the groups differ from each other to learn more\n# about where the variance in the means exists.\n\n# The Tukey Test offers a glimpse at the relationships between all of the\n# pairs and combinations of the groups\nTukeyHSD(zelazo.aov)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  Tukey multiple comparisons of means\n    95% family-wise confidence level\n\nFit: aov(formula = zelazo.df$value ~ zelazo.df$group, data = zelazo.df)\n\n$`zelazo.df$group`\n                    diff        lwr      upr     p adj\npassive-active 1.2500000 -1.2117450 3.711745 0.4982812\nnone-active    1.5833333 -0.8784116 4.045078 0.3000594\nctr.8w-active  2.2250000 -0.3568999 4.806900 0.1063883\nnone-passive   0.3333333 -2.1284116 2.795078 0.9806495\nctr.8w-passive 0.9750000 -1.6068999 3.556900 0.7160591\nctr.8w-none    0.6416667 -1.9402332 3.223567 0.8962600\n```\n\n\n:::\n\n```{.r .cell-code}\n# The adjusted p-value will indicate if there is a significant\n# statistical relationship between two groups.\n\n# The ctr.8w-active is closest to being less than 0.05 at 0.1063883,\n# but is still not considered significant enough to be outside of the 95%\n# confidence level\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}