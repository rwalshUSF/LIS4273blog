{
  "hash": "8617efd8faec3db3c0e46bc1e3015617",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Module 11 Assignment\"\nauthor: \"Robert Walsh\"\nimage: \"LogReg.jpg\"\ndate: \"2025-03-29\"\n---\n\n\n\nExercises in GLM, Matrices, and Logistic Regression!\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# LIS4273 - Module 11. Assignment\n# Robert Walsh\n# Professor Lingyao Li\n\n# Question A.\n\n# Set up an additive model for the ashina data, as part of ISwR package\nlibrary(ISwR)\ndata(\"ashina\")\nattach(ashina)\n# This data contain additive effects on subjects, period and treatment.\n# Compare the results with those obtained from t tests. \nhead(ashina,5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  vas.active vas.plac grp\n1       -167     -102   1\n2       -127      -39   1\n3        -58       32   1\n4       -103       28   1\n5        -35       16   1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Create a new 'ashina$subject' column as a factor w/ values 1-16\nashina$subject<-factor(1:16)\nhead(ashina,5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  vas.active vas.plac grp subject\n1       -167     -102   1       1\n2       -127      -39   1       2\n3        -58       32   1       3\n4       -103       28   1       4\n5        -35       16   1       5\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(ashina)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   vas.active         vas.plac            grp           subject  \n Min.   :-167.00   Min.   :-102.00   Min.   :1.000   1      : 1  \n 1st Qu.: -81.25   1st Qu.: -36.75   1st Qu.:1.000   2      : 1  \n Median : -51.50   Median :  -5.00   Median :1.000   3      : 1  \n Mean   : -56.81   Mean   : -13.94   Mean   :1.375   4      : 1  \n 3rd Qu.: -14.25   3rd Qu.:  11.25   3rd Qu.:2.000   5      : 1  \n Max.   :  29.00   Max.   :  32.00   Max.   :2.000   6      : 1  \n                                                     (Other):10  \n```\n\n\n:::\n\n```{.r .cell-code}\n# Create two data frames:\n\n# 'act' Given active substance & 'plac' given Placebo\n# Include a 'vas' column for the 'vas' summary score value,\n# a 'subject' column for the factored numeric subject count,\n# a 'treat' column (1 for 'active' & 0 for 'placebo')\n# to distinguish between treatment in binary format,\n# and a 'period' column to identify the group number from 'ashina$grp'\n# where '1' got placebo first & '2' got active first.\n\nattach(ashina)\nact<-data.frame(vas=vas.active,subject,treat=1,period=grp)\nplac<-data.frame(vas=vas.plac,subject,treat=0,period=grp)\n\n# In order to fit an additive model, the 'act' & 'plac' data.frames must be\n# combined together using the rbind() function and the binary values\n# converted to factors as well as the subject count.\n\ncombinedData<-rbind(act,plac)\n\n# Now the data frame can be modeled to compare the predictor variables \n# to the response variable to see if there is a significant statistical\n# difference to 'var' values from the additive effects of:\n# 'subject'+'period'+'treat'\n\naddModel<-lm(vas~subject+period+treat,data=combinedData)\nsummary(addModel)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = vas ~ subject + period + treat, data = combinedData)\n\nResiduals:\n   Min     1Q Median     3Q    Max \n-48.94 -18.44   0.00  18.44  48.94 \n\nCoefficients: (1 not defined because of singularities)\n            Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -113.06      27.39  -4.128 0.000895 ***\nsubject2       51.50      37.58   1.370 0.190721    \nsubject3      121.50      37.58   3.233 0.005573 ** \nsubject4       97.00      37.58   2.581 0.020867 *  \nsubject5      125.00      37.58   3.326 0.004604 ** \nsubject6       31.50      37.58   0.838 0.415070    \nsubject7      119.50      37.58   3.180 0.006215 ** \nsubject8      132.00      37.58   3.513 0.003142 ** \nsubject9       80.50      37.58   2.142 0.049003 *  \nsubject10     116.00      37.58   3.087 0.007518 ** \nsubject11     121.50      37.58   3.233 0.005573 ** \nsubject12     154.50      37.58   4.111 0.000925 ***\nsubject13     131.00      37.58   3.486 0.003318 ** \nsubject14     125.00      37.58   3.326 0.004604 ** \nsubject15      99.00      37.58   2.634 0.018768 *  \nsubject16      80.50      37.58   2.142 0.049003 *  \nperiod            NA         NA      NA       NA    \ntreat         -42.87      13.29  -3.227 0.005644 ** \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 37.58 on 15 degrees of freedom\nMultiple R-squared:  0.7566,\tAdjusted R-squared:  0.4969 \nF-statistic: 2.914 on 16 and 15 DF,  p-value: 0.02229\n```\n\n\n:::\n\n```{.r .cell-code}\n# The results show that with an F-statistic of 2.914 and a \n# p-value of 0.02229, the model is significant.\n# For the increase from 0-1 in 'treat', 'vas' decreased by 42.87\n\n# Perform t tests\n\ntTest1<-t.test(vas~treat,data=combinedData)\ntTest1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  vas by treat\nt = 2.4699, df = 24.063, p-value = 0.02099\nalternative hypothesis: true difference in means between group 0 and group 1 is not equal to 0\n95 percent confidence interval:\n  7.052494 78.697506\nsample estimates:\nmean in group 0 mean in group 1 \n       -13.9375        -56.8125 \n```\n\n\n:::\n\n```{.r .cell-code}\n# When testing to determine if 'treat' affects 'vas'\n# The t test results state that the t-statistic is 2.4699\n# with 24.063 degrees of freedom. Because the p-value 0.02099 is less than\n# alpha 0.05 the null hypothesis would be rejected.This concludes that both\n# treatments have a significant effect on the 'vas' scores with the active\n# treatment group showing lower mean 'vas' score compared to the placebo group.\n# The p-value is similar to the p-value from the model summary which\n# indicated that 'treat' was statistically significant.\n\ntTest2<-t.test(vas~period,data=combinedData)\ntTest2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  vas by period\nt = -1.8995, df = 29.872, p-value = 0.0672\nalternative hypothesis: true difference in means between group 1 and group 2 is not equal to 0\n95 percent confidence interval:\n -64.613318   2.346651\nsample estimates:\nmean in group 1 mean in group 2 \n      -47.05000       -15.91667 \n```\n\n\n:::\n\n```{.r .cell-code}\n# When testing to determine if 'period' affects 'vas'\n# The t test results state that the t-statistic is -1.8995\n# with 29.872 degree if freedom. Because the p-value 0.0672 is greater than\n# alpha 0.05 we fail to reject the null. There is not enough evidence to\n# conclude that the 'period' significantly affected the mean 'vas' scores. \n\n# Question B\n\n# Consider the following\na<-gl(2,2,8) # Creates factor with 2 levels,each repeated 2 times,length 8\nb<-gl(2,4,8) # Creates factor with 2 levels,each repeated 4 times,length 8\nx<-1:8\ny<-c(1:4,8:5)\nz<-rnorm(8)\n\n# Instruction: The rnorm() is a built-in R function that generates a vector\n# of normally distributed random numbers. The rnorm() method takes a sample\n# size as input and generates that many random numbers. We are looking for\n# two models: (1) model.matrix (~a:b); (2) lm (z~a:b)\n\n# B1. Your assignment is to generate the model matrices for the following models\n\n# z ~ a*b  # Model with interaction (a*b)\n\nmm1<-model.matrix(~a*b)\nmm1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept) a2 b2 a2:b2\n1           1  0  0     0\n2           1  0  0     0\n3           1  1  0     0\n4           1  1  0     0\n5           1  0  1     0\n6           1  0  1     0\n7           1  1  1     1\n8           1  1  1     1\nattr(,\"assign\")\n[1] 0 1 2 3\nattr(,\"contrasts\")\nattr(,\"contrasts\")$a\n[1] \"contr.treatment\"\n\nattr(,\"contrasts\")$b\n[1] \"contr.treatment\"\n```\n\n\n:::\n\n```{.r .cell-code}\nfmm1<-lm(z~a*b)\nsummary(fmm1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = z ~ a * b)\n\nResiduals:\n      1       2       3       4       5       6       7       8 \n 0.5833 -0.5833  0.2228 -0.2228 -0.1707  0.1707 -0.3337  0.3337 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)\n(Intercept) -0.08041    0.36412  -0.221    0.836\na2           0.63040    0.51494   1.224    0.288\nb2          -0.13257    0.51494  -0.257    0.810\na2:b2       -0.71460    0.72824  -0.981    0.382\n\nResidual standard error: 0.5149 on 4 degrees of freedom\nMultiple R-squared:  0.4547,\tAdjusted R-squared:  0.04573 \nF-statistic: 1.112 on 3 and 4 DF,  p-value: 0.4426\n```\n\n\n:::\n\n```{.r .cell-code}\n# z ~ a:b  # Model with only interaction term (a:b)\n\nmm2<-model.matrix(~a:b)\nmm2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept) a1:b1 a2:b1 a1:b2 a2:b2\n1           1     1     0     0     0\n2           1     1     0     0     0\n3           1     0     1     0     0\n4           1     0     1     0     0\n5           1     0     0     1     0\n6           1     0     0     1     0\n7           1     0     0     0     1\n8           1     0     0     0     1\nattr(,\"assign\")\n[1] 0 1 1 1 1\nattr(,\"contrasts\")\nattr(,\"contrasts\")$a\n[1] \"contr.treatment\"\n\nattr(,\"contrasts\")$b\n[1] \"contr.treatment\"\n```\n\n\n:::\n\n```{.r .cell-code}\nfmm2<-lm(z~a:b)\nsummary(fmm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = z ~ a:b)\n\nResiduals:\n      1       2       3       4       5       6       7       8 \n 0.5833 -0.5833  0.2228 -0.2228 -0.1707  0.1707 -0.3337  0.3337 \n\nCoefficients: (1 not defined because of singularities)\n            Estimate Std. Error t value Pr(>|t|)\n(Intercept)  -0.2972     0.3641  -0.816    0.460\na1:b1         0.2168     0.5149   0.421    0.695\na2:b1         0.8472     0.5149   1.645    0.175\na1:b2         0.0842     0.5149   0.164    0.878\na2:b2             NA         NA      NA       NA\n\nResidual standard error: 0.5149 on 4 degrees of freedom\nMultiple R-squared:  0.4547,\tAdjusted R-squared:  0.04573 \nF-statistic: 1.112 on 3 and 4 DF,  p-value: 0.4426\n```\n\n\n:::\n\n```{.r .cell-code}\n# B2. Please also discuss the implications of using these two models;\n# please be reminded about the model fits and notice\n# which models contain singularities.\n\n# Interaction Model Matrix\nmm1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept) a2 b2 a2:b2\n1           1  0  0     0\n2           1  0  0     0\n3           1  1  0     0\n4           1  1  0     0\n5           1  0  1     0\n6           1  0  1     0\n7           1  1  1     1\n8           1  1  1     1\nattr(,\"assign\")\n[1] 0 1 2 3\nattr(,\"contrasts\")\nattr(,\"contrasts\")$a\n[1] \"contr.treatment\"\n\nattr(,\"contrasts\")$b\n[1] \"contr.treatment\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# This design matrix will include columns for the main effects of a and b,\n# as well as their interaction term (a:b).\n\n# Interaction-term-Only Model Matrix\nmm2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept) a1:b1 a2:b1 a1:b2 a2:b2\n1           1     1     0     0     0\n2           1     1     0     0     0\n3           1     0     1     0     0\n4           1     0     1     0     0\n5           1     0     0     1     0\n6           1     0     0     1     0\n7           1     0     0     0     1\n8           1     0     0     0     1\nattr(,\"assign\")\n[1] 0 1 1 1 1\nattr(,\"contrasts\")\nattr(,\"contrasts\")$a\n[1] \"contr.treatment\"\n\nattr(,\"contrasts\")$b\n[1] \"contr.treatment\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# This design matrix will only include the interaction term (a:b),\n# without main effects. \n\n# Interaction Model Fit\nsummary(fmm1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = z ~ a * b)\n\nResiduals:\n      1       2       3       4       5       6       7       8 \n 0.5833 -0.5833  0.2228 -0.2228 -0.1707  0.1707 -0.3337  0.3337 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)\n(Intercept) -0.08041    0.36412  -0.221    0.836\na2           0.63040    0.51494   1.224    0.288\nb2          -0.13257    0.51494  -0.257    0.810\na2:b2       -0.71460    0.72824  -0.981    0.382\n\nResidual standard error: 0.5149 on 4 degrees of freedom\nMultiple R-squared:  0.4547,\tAdjusted R-squared:  0.04573 \nF-statistic: 1.112 on 3 and 4 DF,  p-value: 0.4426\n```\n\n\n:::\n\n```{.r .cell-code}\n# This model will estimate the effects of a, b,\n# and their interaction on the response variable z\n\n# Interaction-term-Only Model Fit\nsummary(fmm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = z ~ a:b)\n\nResiduals:\n      1       2       3       4       5       6       7       8 \n 0.5833 -0.5833  0.2228 -0.2228 -0.1707  0.1707 -0.3337  0.3337 \n\nCoefficients: (1 not defined because of singularities)\n            Estimate Std. Error t value Pr(>|t|)\n(Intercept)  -0.2972     0.3641  -0.816    0.460\na1:b1         0.2168     0.5149   0.421    0.695\na2:b1         0.8472     0.5149   1.645    0.175\na1:b2         0.0842     0.5149   0.164    0.878\na2:b2             NA         NA      NA       NA\n\nResidual standard error: 0.5149 on 4 degrees of freedom\nMultiple R-squared:  0.4547,\tAdjusted R-squared:  0.04573 \nF-statistic: 1.112 on 3 and 4 DF,  p-value: 0.4426\n```\n\n\n:::\n\n```{.r .cell-code}\n# This model will estimate the effect of the interaction term a:b on z,\n# assuming no separate effects for a or b.\n# A singularity occurs here, probably because the main effects of a and b \n# are highly correlated with the interaction term, and it doesn't account \n# for the separate effects.\n\n# Both models have the same R-squared value, 0.4907, indicating similar\n# explanatory power. However, the significance levels of the coefficients\n# differ between the two models. In the interaction model, you can assess \n# the significance of the main effects and the interaction term separately.\n# In the interaction-term-only model, you can only assess the significance of \n# the interaction term.\n```\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}