{
  "hash": "881e8a7a464171ec4922469ad691e7d5",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Module 11 Assignment\"\nauthor: \"Robert Walsh\"\nimage: \"LogReg.jpg\"\ndate: \"2025-04-02\"\n---\n\n\n\nExercises in GLM, Matrices, and Logistic Regression!\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# LIS4273 - Module 11. Assignment\n# Robert Walsh\n# Professor Lingyao Li\n\n# Question A.\n\n# Set up an additive model for the ashina data, as part of ISwR package\nlibrary(ISwR)\ndata(\"ashina\")\nattach(ashina)\n# This data contain additive effects on subjects, period and treatment.\n# Compare the results with those obtained from t tests. \nhead(ashina,5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  vas.active vas.plac grp\n1       -167     -102   1\n2       -127      -39   1\n3        -58       32   1\n4       -103       28   1\n5        -35       16   1\n```\n\n\n:::\n\n```{.r .cell-code}\n# Create a new 'ashina$subject' column as a factor w/ values 1-16\nashina$subject<-factor(1:16)\nhead(ashina,5)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  vas.active vas.plac grp subject\n1       -167     -102   1       1\n2       -127      -39   1       2\n3        -58       32   1       3\n4       -103       28   1       4\n5        -35       16   1       5\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(ashina)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   vas.active         vas.plac            grp           subject  \n Min.   :-167.00   Min.   :-102.00   Min.   :1.000   1      : 1  \n 1st Qu.: -81.25   1st Qu.: -36.75   1st Qu.:1.000   2      : 1  \n Median : -51.50   Median :  -5.00   Median :1.000   3      : 1  \n Mean   : -56.81   Mean   : -13.94   Mean   :1.375   4      : 1  \n 3rd Qu.: -14.25   3rd Qu.:  11.25   3rd Qu.:2.000   5      : 1  \n Max.   :  29.00   Max.   :  32.00   Max.   :2.000   6      : 1  \n                                                     (Other):10  \n```\n\n\n:::\n\n```{.r .cell-code}\n# Create two data frames:\n\n# 'act' Given active substance & 'plac' given Placebo\n# Include a 'vas' column for the 'vas' summary score value,\n# a 'subject' column for the factored numeric subject count,\n# a 'treat' column (1 for 'active' & 0 for 'placebo')\n# to distinguish between treatment in binary format,\n# and a 'period' column to identify the group number from 'ashina$grp'\n# where '1' got placebo first & '2' got active first.\n\nattach(ashina)\nact<-data.frame(vas=vas.active,subject,treat=1,period=grp)\nplac<-data.frame(vas=vas.plac,subject,treat=0,period=grp)\n\n# In order to fit an additive model, the 'act' & 'plac' data.frames must be\n# combined together using the rbind() function and the binary values\n# converted to factors as well as the subject count.\n\ncombinedData<-rbind(act,plac)\ncombinedData$treat<-factor(combinedData$treat,\n                           labels=c(\"placebo\",\"active\"))\ncombinedData$period<-factor(combinedData$period,\n                           labels=c(\"placFirst\",\"actFirst\"))\nsummary(combinedData)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n      vas             subject       treat          period  \n Min.   :-167.00   1      : 2   placebo:16   placFirst:20  \n 1st Qu.: -58.75   2      : 2   active :16   actFirst :12  \n Median : -32.50   3      : 2                              \n Mean   : -35.38   4      : 2                              \n 3rd Qu.:   4.25   5      : 2                              \n Max.   :  32.00   6      : 2                              \n                   (Other):20                              \n```\n\n\n:::\n\n```{.r .cell-code}\n# Now the data frame can be modeled to compare the predictor variables \n# to the response variable to see if there is a significant statistical\n# difference to 'var' values from the additive effects of:\n# 'subject'+'treat' to see if the placebo or active treatments\n# had a significant effect on vas scores among the 16 subjects.\n\n# Plot the result\nattach(combinedData)\nplot(as.numeric(subject),vas,pch=as.numeric(treat),\n     xlab=\"Subject #\", ylab=\"vas score\",col=treat)\nlegend(x=1,legend=c(\"placebo\",\"active\"),\n       col=c(\"black\",\"red\"),pch=1:2)\naxis(1, at = c(1:16))\n\n# Specify regression line data\nvas.placebo<-combinedData[treat==\"placebo\",]\nvas.active<-combinedData[treat==\"active\",]\n\n# Fit GLM models for effects of treatment on vas scores by subject\nglm.placebo<-glm(vas~as.numeric(subject),data=vas.placebo)\nglm.active<-glm(vas~as.numeric(subject),data=vas.active)\nabline(glm.placebo,col=\"black\")\nabline(glm.active,col=\"red\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-1-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Regression analysis\nsummary(glm.placebo)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = vas ~ as.numeric(subject), data = vas.placebo)\n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)\n(Intercept)          -28.475     18.383  -1.549    0.144\nas.numeric(subject)    1.710      1.901   0.900    0.384\n\n(Dispersion parameter for gaussian family taken to be 1228.886)\n\n    Null deviance: 18199  on 15  degrees of freedom\nResidual deviance: 17204  on 14  degrees of freedom\nAIC: 163.09\n\nNumber of Fisher Scoring iterations: 2\n```\n\n\n:::\n\n```{.r .cell-code}\n# The results show that with a t-value of 0.900 and a \n# p-value of 0.384, the placebo treatment did not have a significant\n# enough effect on vas scores among the 16 subjects to reject the null.\nsummary(glm.active)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = vas ~ as.numeric(subject), data = vas.active)\n\nCoefficients:\n                    Estimate Std. Error t value Pr(>|t|)   \n(Intercept)         -111.375     28.070  -3.968   0.0014 **\nas.numeric(subject)    6.419      2.903   2.211   0.0442 * \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for gaussian family taken to be 2865.194)\n\n    Null deviance: 54122  on 15  degrees of freedom\nResidual deviance: 40113  on 14  degrees of freedom\nAIC: 176.64\n\nNumber of Fisher Scoring iterations: 2\n```\n\n\n:::\n\n```{.r .cell-code}\n# The results show that with a t-value of 2.211 and a \n# p-value of 0.0442, the active treatment had a significant\n# effect on vas scores among the 16 subjects. We can reject the null.\n\n# Create 'logit' function for logistic regression\nlogit  <- function(p) log(p/(1-p))\n\n# GLM Model to determine if 'vas, subject, or period' predictor variables\n# increases or decreases the odds of the outcome 'treat' group\nmodel <- glm(treat ~ .,family = binomial(logit), data=combinedData)\nsummary(model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = treat ~ ., family = binomial(logit), data = combinedData)\n\nCoefficients: (1 not defined because of singularities)\n               Estimate Std. Error z value Pr(>|z|)   \n(Intercept)    -8.08937    3.50126  -2.310  0.02087 * \nvas            -0.06014    0.02057  -2.923  0.00346 **\nsubject2        3.09742    3.71629   0.833  0.40458   \nsubject3        7.30749    4.40133   1.660  0.09686 . \nsubject4        5.83397    5.94041   0.982  0.32606   \nsubject5        7.51800    3.82633   1.965  0.04944 * \nsubject6        1.89454    5.06324   0.374  0.70827   \nsubject7        7.18721    3.59417   2.000  0.04553 * \nsubject8        7.93901    3.96059   2.005  0.04502 * \nsubject9        4.84159    3.07156   1.576  0.11497   \nsubject10       6.97670    3.72291   1.874  0.06093 . \nsubject11       7.30749    3.76965   1.939  0.05256 . \nsubject12       9.29225    4.10554   2.263  0.02361 * \nsubject13       7.87886    3.73104   2.112  0.03471 * \nsubject14       7.51800    3.65361   2.058  0.03962 * \nsubject15       5.95426    3.85548   1.544  0.12250   \nsubject16       4.84159    3.16071   1.532  0.12557   \nperiodactFirst       NA         NA      NA       NA   \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 44.361  on 31  degrees of freedom\nResidual deviance: 28.281  on 15  degrees of freedom\nAIC: 62.281\n\nNumber of Fisher Scoring iterations: 5\n```\n\n\n:::\n\n```{.r .cell-code}\n# Use AIC to fit model selection\nmodel2 <- step(model,data=combinedData)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nStart:  AIC=62.28\ntreat ~ vas + subject + period\n\n\nStep:  AIC=62.28\ntreat ~ vas + subject\n\n          Df Deviance    AIC\n- subject 15   38.342 42.342\n<none>         28.281 62.281\n- vas      1   44.361 76.361\n\nStep:  AIC=42.34\ntreat ~ vas\n\n       Df Deviance    AIC\n<none>      38.342 42.342\n- vas   1   44.361 46.361\n```\n\n\n:::\n\n```{.r .cell-code}\nsummary(model2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = treat ~ vas, family = binomial(logit), data = combinedData)\n\nCoefficients:\n             Estimate Std. Error z value Pr(>|z|)  \n(Intercept) -0.639381   0.471332  -1.357   0.1749  \nvas         -0.019715   0.009389  -2.100   0.0357 *\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 44.361  on 31  degrees of freedom\nResidual deviance: 38.342  on 30  degrees of freedom\nAIC: 42.342\n\nNumber of Fisher Scoring iterations: 4\n```\n\n\n:::\n\n```{.r .cell-code}\n# The results show that the estimates (log odds) -0.019715 are negative for 'vas'\n# A negative log-odds ratio means that the odds go down with an\n# increase in the value of the predictor variable.\n# Therefore the odds of determining a treatment group 'treat' decreases\n# with observed/summarized 'vas' score increases. \n# A Z-value of -2.100 and a p value of 0.0357, suggest that we can reject\n# the null, and that 'vas' has a significant effect on 'treat'.\n\n# Perform t test\n\ntTest1<-t.test(vas~treat,data=combinedData)\ntTest1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\n\tWelch Two Sample t-test\n\ndata:  vas by treat\nt = 2.4699, df = 24.063, p-value = 0.02099\nalternative hypothesis: true difference in means between group placebo and group active is not equal to 0\n95 percent confidence interval:\n  7.052494 78.697506\nsample estimates:\nmean in group placebo  mean in group active \n             -13.9375              -56.8125 \n```\n\n\n:::\n\n```{.r .cell-code}\n# When testing to determine if 'treat' affects 'vas'\n# The t test results state that the t-statistic is 2.4699\n# with 24.063 degrees of freedom. Because the p-value 0.02099 is less than\n# alpha 0.05 the null hypothesis would be rejected.This concludes that both\n# treatments have a significant effect on the 'vas' scores with the active\n# treatment group showing lower mean 'vas' score compared to the placebo group.\n# The p-value is similar to the p-value from the model summary which\n# indicated that 'treat' was statistically significant.\n\n\n#---------------------------------------------------------------------------#\n\n\n# Question B\n\n# Consider the following\na<-gl(2,2,8) # Creates factor with 2 levels,each repeated 2 times,length 8\nb<-gl(2,4,8) # Creates factor with 2 levels,each repeated 4 times,length 8\nx<-1:8\ny<-c(1:4,8:5)\nz<-rnorm(8)\n\n# Instruction: The rnorm() is a built-in R function that generates a vector\n# of normally distributed random numbers. The rnorm() method takes a sample\n# size as input and generates that many random numbers. We are looking for\n# two models: (1) model.matrix (z~a:b); (2) lm (z~a:b)\n\n# B1. Your assignment is to generate the model matrices for the following models\n\n# z ~ a*b  # Model with interaction (a*b)\n\nmm1<-model.matrix(z~a*b)\nmm1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept) a2 b2 a2:b2\n1           1  0  0     0\n2           1  0  0     0\n3           1  1  0     0\n4           1  1  0     0\n5           1  0  1     0\n6           1  0  1     0\n7           1  1  1     1\n8           1  1  1     1\nattr(,\"assign\")\n[1] 0 1 2 3\nattr(,\"contrasts\")\nattr(,\"contrasts\")$a\n[1] \"contr.treatment\"\n\nattr(,\"contrasts\")$b\n[1] \"contr.treatment\"\n```\n\n\n:::\n\n```{.r .cell-code}\nfmm1<-lm(z~a*b)\nsummary(fmm1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = z ~ a * b)\n\nResiduals:\n      1       2       3       4       5       6       7       8 \n 1.7513 -1.7513 -0.4452  0.4452  0.5664 -0.5664  1.2722 -1.2722 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)\n(Intercept)  -0.3927     1.1407  -0.344    0.748\na2            0.8345     1.6131   0.517    0.632\nb2           -0.1630     1.6131  -0.101    0.924\na2:b2        -0.6198     2.2813  -0.272    0.799\n\nResidual standard error: 1.613 on 4 degrees of freedom\nMultiple R-squared:  0.1026,\tAdjusted R-squared:  -0.5705 \nF-statistic: 0.1524 on 3 and 4 DF,  p-value: 0.9229\n```\n\n\n:::\n\n```{.r .cell-code}\n# z ~ a:b  # Model with only interaction term (a:b)\n\nmm2<-model.matrix(z~a:b)\nmm2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept) a1:b1 a2:b1 a1:b2 a2:b2\n1           1     1     0     0     0\n2           1     1     0     0     0\n3           1     0     1     0     0\n4           1     0     1     0     0\n5           1     0     0     1     0\n6           1     0     0     1     0\n7           1     0     0     0     1\n8           1     0     0     0     1\nattr(,\"assign\")\n[1] 0 1 1 1 1\nattr(,\"contrasts\")\nattr(,\"contrasts\")$a\n[1] \"contr.treatment\"\n\nattr(,\"contrasts\")$b\n[1] \"contr.treatment\"\n```\n\n\n:::\n\n```{.r .cell-code}\nfmm2<-lm(z~a:b)\nsummary(fmm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = z ~ a:b)\n\nResiduals:\n      1       2       3       4       5       6       7       8 \n 1.7513 -1.7513 -0.4452  0.4452  0.5664 -0.5664  1.2722 -1.2722 \n\nCoefficients: (1 not defined because of singularities)\n            Estimate Std. Error t value Pr(>|t|)\n(Intercept) -0.34102    1.14065  -0.299    0.780\na1:b1       -0.05165    1.61313  -0.032    0.976\na2:b1        0.78287    1.61313   0.485    0.653\na1:b2       -0.21467    1.61313  -0.133    0.901\na2:b2             NA         NA      NA       NA\n\nResidual standard error: 1.613 on 4 degrees of freedom\nMultiple R-squared:  0.1026,\tAdjusted R-squared:  -0.5705 \nF-statistic: 0.1524 on 3 and 4 DF,  p-value: 0.9229\n```\n\n\n:::\n\n```{.r .cell-code}\n# B2. Please also discuss the implications of using these two models;\n# please be reminded about the model fits and notice\n# which models contain singularities.\n\n# Interaction Model Matrix\nmm1\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept) a2 b2 a2:b2\n1           1  0  0     0\n2           1  0  0     0\n3           1  1  0     0\n4           1  1  0     0\n5           1  0  1     0\n6           1  0  1     0\n7           1  1  1     1\n8           1  1  1     1\nattr(,\"assign\")\n[1] 0 1 2 3\nattr(,\"contrasts\")\nattr(,\"contrasts\")$a\n[1] \"contr.treatment\"\n\nattr(,\"contrasts\")$b\n[1] \"contr.treatment\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# This design matrix will include columns for the main effects of a and b,\n# as well as their interaction term (a:b).\n\n# Interaction-term-Only Model Matrix\nmm2\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n  (Intercept) a1:b1 a2:b1 a1:b2 a2:b2\n1           1     1     0     0     0\n2           1     1     0     0     0\n3           1     0     1     0     0\n4           1     0     1     0     0\n5           1     0     0     1     0\n6           1     0     0     1     0\n7           1     0     0     0     1\n8           1     0     0     0     1\nattr(,\"assign\")\n[1] 0 1 1 1 1\nattr(,\"contrasts\")\nattr(,\"contrasts\")$a\n[1] \"contr.treatment\"\n\nattr(,\"contrasts\")$b\n[1] \"contr.treatment\"\n```\n\n\n:::\n\n```{.r .cell-code}\n# This design matrix will only include the interaction term (a:b),\n# without main effects. \n\n# Interaction Model Fit\nsummary(fmm1)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = z ~ a * b)\n\nResiduals:\n      1       2       3       4       5       6       7       8 \n 1.7513 -1.7513 -0.4452  0.4452  0.5664 -0.5664  1.2722 -1.2722 \n\nCoefficients:\n            Estimate Std. Error t value Pr(>|t|)\n(Intercept)  -0.3927     1.1407  -0.344    0.748\na2            0.8345     1.6131   0.517    0.632\nb2           -0.1630     1.6131  -0.101    0.924\na2:b2        -0.6198     2.2813  -0.272    0.799\n\nResidual standard error: 1.613 on 4 degrees of freedom\nMultiple R-squared:  0.1026,\tAdjusted R-squared:  -0.5705 \nF-statistic: 0.1524 on 3 and 4 DF,  p-value: 0.9229\n```\n\n\n:::\n\n```{.r .cell-code}\n# This model will estimate the effects of a, b,\n# and their interaction on the response variable z\n\n# Interaction-term-Only Model Fit\nsummary(fmm2)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nlm(formula = z ~ a:b)\n\nResiduals:\n      1       2       3       4       5       6       7       8 \n 1.7513 -1.7513 -0.4452  0.4452  0.5664 -0.5664  1.2722 -1.2722 \n\nCoefficients: (1 not defined because of singularities)\n            Estimate Std. Error t value Pr(>|t|)\n(Intercept) -0.34102    1.14065  -0.299    0.780\na1:b1       -0.05165    1.61313  -0.032    0.976\na2:b1        0.78287    1.61313   0.485    0.653\na1:b2       -0.21467    1.61313  -0.133    0.901\na2:b2             NA         NA      NA       NA\n\nResidual standard error: 1.613 on 4 degrees of freedom\nMultiple R-squared:  0.1026,\tAdjusted R-squared:  -0.5705 \nF-statistic: 0.1524 on 3 and 4 DF,  p-value: 0.9229\n```\n\n\n:::\n\n```{.r .cell-code}\n# This model will estimate the effect of the interaction term a:b on z,\n# assuming no separate effects for a or b.\n# A singularity occurs here, probably because the main effects of a and b \n# are highly correlated with the interaction term, and it doesn't account \n# for the separate effects.\n\n# Both models have the same R-squared value, indicating similar\n# explanatory power. However, the significance levels of the coefficients\n# differ between the two models. In the interaction model, you can assess \n# the significance of the main effects and the interaction term separately.\n# In the interaction-term-only model, you can only assess the significance of \n# the interaction term.\n```\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}